---
title: "Homework Problem Set 6: Sampling Distributions of $\\bar{x}$ and $\\hat{p}$"
output: 
  html_document: 
    theme: readable
header-includes:
  - \usepackage{array}
  - \usepackage{booktabs}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, out.width = "100%", fig.align = "center", 
  cache = FALSE, dev = ifelse(knitr::is_html_output(), "png", "pdf"))
```

```{r packages}
library(tidyverse)
library(kableExtra)
```

```{r utilities}
source("../../utilities.R")
```

`r ifelse(knitr::is_html_output(), paste("You can also download a [PDF](homework-06.pdf) copy of this homework assignment.", sep = ""), "")`

Answers are given at the end. 

## Darwin's Fertilization Study

```{r}
m.darwin <- 3
s.darwin <- 5
n.darwin <- 25 
p.darwin <- 0.8
```
  
Charles Darwin conducted a study of the heights of corn seedlings produced from cross- versus self-fertilization.[^darwin] In that study seedlings were obtained from seeds from the same plant, but one seedling was obtained from a flower that had been cross-fertilized and the other produced from a flower that had been self-fertilized. A single observation is based on the difference in the heights of the pair of seedlings produced by each pair of seeds. His study used only 15 observations. Suppose we were to replicate his study today, but using a larger sample size.

1. Suppose we observe the difference in the heights of each pair of seedlings by subtracting the height of the seedling produced from self-fertilization from the height of the seedling produced from cross-fertilization. We will let $x$ denote this variable. Assume that this variable has a mean of `r m.darwin` inches and a standard deviation of `r s.darwin` inches. What are the mean and standard deviation of the mean ($\bar{x}$) computed from a sample of `r n.darwin` observations? And what is the interval that has a probability of approximately 0.95 of containing $\bar{x}$?

2. Suppose that rather than observing the difference in seedling heights we simply observe whether or not the seedling produced from cross-fertilization is taller. If we let $x$ denote this observation and suppose that the probability of that the seedling produced from cross-fertilization is taller is `r p.darwin`. We can summarize the population distribution in the following table.[^ties]
    ```{r}
    d <- data.frame(x = c("cross","self"), p = c(p.darwin, 1 - p.darwin))
    names(d) <- c("$x$","$P(x)$")
    ktbl(d)
    ```
Let $\hat{p}$ denote the proportion of observations in a sample of 25 observations where the seedling produced from cross-fertilization is taller. What are the mean and standard deviation of $\hat{p}$? And what is the interval that has a probability of approximately 0.95 of containing $\hat{p}$? 

[^darwin]: Darwin, C. (1876). *The Effect of Cross- and Self-fertilization in the Vegetable Kingdom, 2nd Ed*. London: John Murray.

[^ties]: Assume that we measure height accurately enough so that there will not be any seedling pairs where both seedlings are exactly the same height. 

## Trebuchet or 6-Sided Die

Suppose we have a model trebuchet like the one I brought to lecture. Let $x$ be the distance, rounded to the nearest meter, that the trebuchet will throw an object. Suppose that the distribution of $x$ is as given in the table below.
```{r}
k <- 6
m <- (1 + k)/2
s <- sqrt((k^2 - 1)/12)
d <- data.frame(x = 1:k, p = paste("1/", k, sep = ""))
names(d) <- c("$x$","$P(x)$")
ktbl(d)
```
This is our *population distribution*. Using the formulas $\mu = \sum_x xP(x)$ and $\sigma = \sqrt{\sum_x (x-\mu)^2 P(x)}$ it can be shown that this distribution has a mean of $\mu$ = `r m` and a standard deviation of $\sigma \approx$ `r round(s,2)`. This distribution is the same as that as a fair 6-sided die. 

1. Consider the *sampling distribution* for the mean ($\bar{x}$) of a sample of five observations. This would be equivalent to the distribution of the mean of five rolls of a fair 6-sided die. I derived this distribution using the five-step method (but with a computer). It is shown below. 
```{r, fig.height = 4}
x <- 1:6
n <- 5
p <- rep(1/6,6)

dy <- vector(mode = "list", length = n)
dp <- vector(mode = "list", length = n)

for (i in 1:n) {
  dy[[i]] <- x
  dp[[i]] <- p
}
d <- data.frame(x = apply(expand.grid(dy), 1, mean), p = apply(expand.grid(dp), 1, prod)) %>% group_by(x) %>% summarize(p = sum(p))

p <- ggplot(d, aes(x = x, y = p)) + theme_minimal()
p <- p + geom_point() + geom_segment(aes(yend = 0, xend = x))
p <- p + scale_x_continuous(breaks = seq(1, 6, by = 1))
p <- p + labs(x = tex("$\\bar{x}$"), y = "Probability")
plot(p)
```
What are the mean and standard deviation of $\bar{x}$? What is the interval that has a probability of approximately 0.95 of containing $\bar{x}$?

2. Now suppose we increase the sample size to 25. For a larger sample size like this we can depict the sampling distribution more abstractly using a curve as shown below rather than using points as used in the previous problem.
```{r, fig.height = 4, warning = FALSE}
x <- seq(1, 6, length = 1000)
y <- dnorm(x, m, s/sqrt(25))
d <- data.frame(x,y)

a <- m - 2*s/sqrt(25)
b <- m + 2*s/sqrt(25)

p <- ggplot(d, aes(x = x, y = y)) + theme_minimal()
p <- p + geom_line() + noyaxis + labs(x = tex("$\\bar{x}$"))
p <- p + scale_x_continuous(breaks = c(1,a,b,6), labels = c(1,"a", "b",6), limits = c(1,6))
p <- p + geom_area(mapping = aes(ifelse(x > a & x < b, x, 0)), alpha = 0.5)
plot(p)
```
What are the mean and standard deviation of $\bar{x}$, and what is the interval that has a probability of approximately 0.95 of containing $\bar{x}$?

## Ambivalent Platys or a Coin Flip

Recall the experiment on the preferences of female platys for yellow- versus clear-tailed males. Suppose that there is no genetic predisposition among female platys to prefer or be averse to a yellow versus a clear tail. In that case the *population distribution* of which male is preferred would be as shown below.
```{r}
d <- data.frame(x = c("yellow","clear"), c(0.5,0.5))
names(d) <- c("$x$","$P(x)$")
m <- 0.5
s <- sqrt(0.5*(1-0.5))
ktbl(d)
```
This would be analogous to flipping a fair coin with "heads" instead of "yellow" and "tails" instead of "clear." 

1. Consider the *sampling distribution* of the proportion ($\hat{p}$) of observations out of a sample of 25 observations where the female platy appears to prefer the yellow-tailed male. This would be equivalent to flipping a fair coin 25 times and computing the proportion flips on which the coin came up heads. I derived this distribution using the formula for the binomial distribution (with the help of a computer). It is shown below. 
```{r, fig.height = 4}
n <- 25
d <- data.frame(x = c(0:n)/n, y = dbinom(0:n, n, 0.5))

p <- ggplot(d, aes(x = x, y = y)) + theme_minimal()
p <- p + geom_point() + geom_segment(aes(yend = 0, xend = x))
p <- p + scale_x_continuous(breaks = seq(0, 1, by = 0.1))
p <- p + labs(x = tex("$\\hat{p}$"), y = "Probability")
plot(p)
```
What are the mean and standard deviation of $\hat{p}$?

2. Now suppose we increase the sample size to 100. For a larger sample size like this we can depict the sampling distribution more abstractly using a curve as shown below rather than using points as used in the previous problem. 
```{r, fig.height = 4, warning = FALSE}
x <- seq(0, 1, length = 1000)
y <- dnorm(x, m, s/sqrt(100))
d <- data.frame(x,y)

a <- m - 2*s/sqrt(100)
b <- m + 2*s/sqrt(100)

p <- ggplot(d, aes(x = x, y = y)) + theme_minimal()
p <- p + geom_line() + noyaxis + labs(x = tex("$\\hat{p}$"))
p <- p + scale_x_continuous(breaks = c(0,a,b,1), labels = c(0,"a","b",1), limits = c(0,1))
p <- p + stat_function(fun = dnorm, geom = "area", alpha = 0.5, xlim = c(a,b), args = list(mean = m, sd = s/sqrt(100)))
plot(p)
```
The points $a$ and $b$ denote the interval that has a probability of approximately 0.95 of containing $\hat{p}$. What is this interval --- that is, what are $a$ and $b$? (Note: You will need to first find the mean and standard deviation of the sampling distribution to find this interval.)

## Mendel's Peas

[Gregor Mendel](https://en.wikipedia.org/wiki/Gregor_Mendel) was a 19th century Augustinian friar who conducted experiments with pea plants to investigating heredity. In one classic experiment he bred pea plants by crossing plants from a strain that only produced green peas with another strain that only produced yellow peas. The first-generation offspring from this crossbreeding then produced a strain of pea plants that were presumed to carried the genes for both yellow and green peas --- one from each parent. However these plants only had yellow seeds because it was assumed that the yellow genes are dominant in the sense that an offspring with at least one gene for yellow peas will always have yellow peas. The only way for a plant to have green peas is if both genes were for green peas. The plants from the first-generation offspring were then crossed with themselves to produce the second-generation offspring. Based on assumptions about how inheritance works, Mendel hypothesized that the probability of a second-generation offspring having yellow peas is 0.75, while the probability of green peas is 0.25. This implies the following population distribution. 
```{r}
d <- data.frame(x = c("yellow","green"), p = c(0.75,0.25))
names(d) <- c("$x$","$P(x)$")
ktbl(d)
```
Mendel checked his hypothesis by observing many offspring and computing the proportion of offspring that had yellow peas, which we would call $\hat{p}$. The idea is that if that proportion is relatively close to 0.75, then it would support his hypothesis. Mendel bred 8023 offspring in his study. Assuming Mendel is correct in that the probability that a single offspring will have yellow peas is 0.75, what are the mean and standard deviation of $\hat{p}$ based on a sample of 8023 observations? And what is the interval that has a probability of approximately 0.95 of containing $\hat{p}$? 

## Twin Study of Anatomical Differences in Schizophrenics

A twin study was conducted to investigate anatomical differences between people affected and unaffected by schizophrenia.[^schizo] This study used 15 pairs of identical twins where one twin was affected but the other was unaffected. One variable the researchers considered was the volume of the left hippocampus (in cubic cm). The data are shown below.
```{r}
d <- Sleuth3::case0202
d$Difference <- with(d, Unaffected - Affected)
n <- nrow(d)
d$Pair = 1:n
d <- d[,c(4,1,2,3)]
ktbl(headtail(round(d,2), 5)) %>% add_header_above(c(" " = 1, "Twin" = 2, " " = 1))
```
Here we will consider observations of the variable $x$, representing the difference in the hippocampus volume of a pair of twins. Suppose that there is no relationship between schizophrenia and left hippocampus volume. Then the mean of the population distribution of $x$ would be zero. Assume also that the population distribution of $x$ has a standard deviation of 0.25 cubic cm. Let $\bar{x}$ denote the mean difference in a sample of 15 observations. What are the mean and standard deviation of $\bar{x}$? And what is the interval that has a probability of approximately 0.95 of containing $\bar{x}$? 

[^schizo]: Suddath, R. L., Christison, G. W., Torrey, E. F., Casanova, M. F. & Weinberger, D. R. (1990). Anatomical abnormalities in the brains of monozygotic twins discordant for schizophrenia. *New England Journal of Medicine*, *322(12)*, 789--794.

\pagebreak

## Darwin's Fertilization Study (Solution)

1. The sampling distribution has a mean of 3 inches and a standard deviation of 1 inch. The interval is 1 to 5 inches.

0. The sampling distribution has a mean of 0.8 and a standard deviation of `r sqrt(0.8*(1-0.8)/25)`. The interval is `r 0.8 - 2*sqrt(0.8*(1-0.8)/25)` to `r 0.8 + 2*sqrt(0.8*(1-0.8)/25)`.

## Trebuchet or 6-Sided Die (Solution)

1. The mean is 3.5 meters and the standard deviation is `r rnd (1.71/sqrt(5),2)` meters. The interval is approximately `r round(3.5 - 2*1.71/sqrt(5),2)` to `r round(3.5 + 2*1.71/sqrt(5),2)` meters.

0. The mean is 3.5 meters and the standard deviation is `r rnd (1.71/sqrt(25),2)` meters. The interval is approximately `r round(3.5 - 2*1.71/sqrt(25),2)` to `r round(3.5 + 2*1.71/sqrt(25),2)` meters.

## Ambivalent Platys or a Coin Flip (Solution)

1. The mean is 0.5 and the standard deviation is `r sqrt(0.5*(1-0.5)/25)`. The interval is `r 0.5 - 2*sqrt(0.5*(1-0.5)/25)` to `r 0.5 + 2*sqrt(0.5*(1-0.5)/25)`.

0. The mean is 0.5 and the standard deviation is `r sqrt(0.5*(1-0.5)/100)`. The interval is `r 0.5 - 2*sqrt(0.5*(1-0.5)/100)` to `r 0.5 + 2*sqrt(0.5*(1-0.5)/100)`.

## Mendel's Peas (Solution)

The mean is 0.75 and the standard deviation is approximately `r round(sqrt(0.75*(1-0.75)/8023),3)`. The interval is approximately `r round(0.75 - 2*sqrt(0.75*(1-0.75)/8023),3)` to `r round(0.75 + 2*sqrt(0.75*(1-0.75)/8023),3)`.

## Twin Study of Anatomical Differences in Schizophrenics (Solution)

The mean is 0 cubic cm and the standard deviation is approximately `r round(0.25/sqrt(15),2)` cubic cm. The interval is approximately `r round(0 - 2*0.25/sqrt(15),2)` to `r round(0 + 2*0.25/sqrt(15),2)` cubic cm.


```{r}
rm(list = ls())
```

