---
title: "Homework Problem Set 5: Deriving Sampling Distributions"
output: 
  html_document: 
    theme: readable
header-includes:
  - \usepackage{array}
  - \usepackage{booktabs}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, out.width = "100%", fig.align = "center", 
  cache = FALSE, dev = ifelse(knitr::is_html_output(), "png", "pdf"))
```

```{r packages}
library(tidyverse)
suppressWarnings(library(kableExtra))
```

```{r utilities}
source("../../utilities.R")
```

`r ifelse(knitr::is_html_output(), paste("You can also download a [PDF](homework-05.pdf) copy of this homework assignment.", sep = ""), "")`

Solutions are given at the end. 

## Sampling Distribution of a Mean

```{r}
treepop <- data.frame(Volume = c(20,30), Probability = c(0.7,0.3))
names(treepop) <- c("$x$","$P(x)$")
```

Consider again the probability distribution for a single observation for the tree volume survey from lecture (i.e., a *population distribution*), but with different probabilities. Here $x$ denotes the volume of a randomly selected tree.
```{r}
ktbl(treepop)
```
Use the five-step method to derive *two* sampling distributions of the mean from a sample of observations ($\bar{x}$): one based on a sample size of $n$ = 2, and a second based on a sample size of $n$ = 3. (Hint: When $n$ = 2 there are four possible samples in the sample space, and one of these samples is 20, 30. But when $n$ = 3 there are eight possible samples, and one of these samples is 20, 20, 30.)

## Sampling Distribution of a Median

In the previous problem you derived the sampling distribution of the *mean* volume of a random sample of $n$ = 3 observations of the volumes of trees. Now use the five-step method to derive the sampling distribution of the *median* volume of a random sample of $n$ = 3 observations of the volumes of trees. Recall that the median is defined as the middle observation when the observations are arranged in increasing order. (Hint: You can use the same sample space that you obtained when you were deriving the sampling distribution of the mean.) 

## Sampling Distribution of a Proportion

```{r}
platypop <- data.frame(Preference = c("C","Y"), Probability = c(0.4,0.6))
names(platypop) <- c("$x$","$P(x)$")
```

1. Consider again the population distribution from lecture for the preference of one female platy fish, but with different probabilities.
```{r}
ktbl(platypop)
```
Here $C$ and $Y$ represent a preference for the clear-tailed and the yellow-tailed male, respectively. Use the five-step method to derive the sampling distribution of the proportion ($\hat{p}$) of platy fish in a sample of $n$ = 2 observations that show a preference for the yellow-tailed male. Then use the five-step method to derive the sampling distribution when the sample size is $n$ = 3.

2. The *number* of observations on which the female platy prefers the yellow-tailed male has a *binomial distribution*. Note that we define a "success" as a female preferring the yellow-tailed male, and so the probability of a success is as given by the population distribution. Derive the sampling distribution for the proportion of observations out of $n$ = 2 on which the female platy prefers the yellow-tailed male using the formula for the binomial distribution. Then use the binomial distribution formula to derive the sampling distribution for a sample size of $n$ = 3. Note that you should get the same sampling distributions using the formula for the binomial distribution as you did when you used the five-step method in the previous problem.

\pagebreak

## Sampling Distribution of a Mean (Solution)

The sampling distribution of $\bar{x}$ when $n$ = 2 is shown in the following table.
```{r}
x <- c(20,30)
x <- unique(expand.grid(x,x))
p <- c(0.7,0.3)
p <- unique(expand.grid(p,p))
x <- apply(x, 1, mean)
p <- apply(p, 1, prod)
d <- data.frame(x, p)
library(dplyr)
d <- d %>% group_by(x) %>% summarize(p = sum(p))
names(d) <- c("$\\bar{x}$","$P(\\bar{x})$")
ktbl(d)
```
The sampling distribution of $\bar{x}$ when $n$ = 3 is shown in the following table.
```{r}
x <- c(20,20,30)
x <- unique(expand.grid(x,x,x))
p <- c(0.7,0.7,0.3)
p <- unique(expand.grid(p,p,p))
x <- apply(x, 1, mean)
p <- apply(p, 1, prod)
d <- data.frame(x, p)
library(dplyr)
d <- d %>% group_by(x) %>% summarize(p = sum(p))
d$x <- round(d$x, 2)
names(d) <- c("$\\bar{x}$","$P(\\bar{x})$")
ktbl(d)
```
Note that the sample mean has been rounded in the case when $n$ = 3.

## Sampling Distribution of a Median (Solution)

The following table shows the sampling distribution of the median. Here I am using $m$ to represent the median.
```{r}
x <- c(20,20,30)
x <- unique(expand.grid(x,x,x))
p <- c(0.7,0.7,0.3)
p <- unique(expand.grid(p,p,p))
x <- apply(x, 1, median)
p <- apply(p, 1, prod)
d <- data.frame(x, p)
library(dplyr)
d <- d %>% group_by(x) %>% summarize(p = sum(p))
d$x <- round(d$x, 2)
names(d) <- c("$m$","$P(m)$")
ktbl(d)
```

## Sampling Distribution of a Proportion (Solution)

The following table shows the sampling distribution of the proportion when $n$ = 2.
```{r}
x = c(0,1,2)/2
p = dbinom(0:2, 2, 0.6)
d <- data.frame(Proportion = x, Probability = p)
names(d) <- c("$\\hat{p}$","$P(\\hat{p})$")
ktbl(d)
```
The following table shows the sampling distribution of the proportion when $n$ = 3.
```{r}
x = c(0,1,2,3)/3
p = dbinom(0:3, 3, 0.6)
d <- data.frame(Proportion = as.character(MASS::fractions(x)), Probability = p)
names(d) <- c("$\\hat{p}$","$P(\\hat{p})$")
ktbl(d)
```

```{r}
rm(list = ls())
```

