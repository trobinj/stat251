---
title: "Homework Problem Set 1: Describing Distributions"
output: 
  html_document: 
    theme: readable
header-includes:
  - \usepackage{array}
  - \usepackage{booktabs}
  - \usepackage{array}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, out.width = "100%", fig.align = "center", 
  cache = FALSE, dev = ifelse(knitr::is_html_output(), "png", "pdf"))
```

```{r packages}
library(tidyverse)
library(kableExtra)
```

```{r}
source("../../utilities.R")
```

`r ifelse(knitr::is_html_output(), paste("You can also download a [PDF](homework-01.pdf) copy of this homework assignment.", sep = ""), "")`

The purpose of these homework problems is to help check your understanding of the description of the distribution of a quantitative variable and its representation/summarization through the use of histograms, dot plots, means, variances, and standard deviations. Note that in some problems the answers are given and you are asked to *confirm* or *verify* the answer. In these problems you should attempt to arrive at the same answer. The solutions to other problems are given at the end. 

## Tabular Representations of Distributions

```{r}
set.seed(101)
y <- rpois(10, 5)
```

1.$\!$ Consider the following set of `r length(y)` observations of a quantitative variable.

<center>

`r paste(sort(y), collapse = ", ")`

</center>

Construct a table that summarizes the distribution with columns for frequency, relative frequency, and cumulative relative frequency.

```{r}
set.seed(103)
y <- rpois(10, 5)
```

2.$\!$ The distribution of a set of `r length(y)` observations of a quantitative variable is described by the table below.

```{r}
d <- data.frame(y = y) %>% group_by(y) %>% summarize(freq = n()) %>% 
  mutate(relfreq = freq/sum(freq), cumrelfreq = cumsum(relfreq))
names(d) <- c("$x$","Frequency","Relative Frequency","Cumulative Relative Frequency")
ktbl(d) %>% column_spec(1:4, width = "2cm")
```

Give the original set of `r length(y)` observations of the variable.

## Histograms

1.$\!$ In lecture we discussed data from a study that investigated a relationship between extrinsic versus intrinsic motivation and creativity. When I presented this data set in lecture I simplified it slightly by rounding the poem scores. Here I will present the actual data. The poem scores for the students who were primed with *extrinsic* motivation are as follows:

<center>

`r vecprnt(sort(subset(Sleuth3::case0101, Treatment == "Extrinsic")$Score), conjunction = NA)`

</center>

The poem scores for the students who were primed with *intrinsic* motivation are as follows:

<center>

`r vecprnt(sort(subset(Sleuth3::case0101, Treatment == "Intrinsic")$Score), conjunction = NA)`

</center>

For your convenience the observations have been sorted in increasing order. Construct two histograms --- one for each set of observations --- using relative frequency. For your histograms use intervals that are 5 units wide and start at 0 (i.e., 0 to 5, 5 to 10, 10 to 15, etc). For any observations that are "on the border" between two intervals (e.g., 5), put that observation in the *lower* interval (e.g., a 5 would go in the interval 0 to 5, not the interval 5 to 10). 

```{r}
set.seed(103)
f <- function() {
  repeat {
    y <- round(runif(10, 0, 10), 1)
    if (!any(y %in% 0:10)) {
      break
    }
  }  
  return(sort(y))
}
x1 <- f()
x2 <- f()
x3 <- f()
x4 <- f()
```

2.$\!$ Consider the following four sets of observations of a quantitative variable $x$. For your convenience the observations have been sorted in increasing order.

a. `r vecprnt(x1, conjunction = NA)`
b. `r vecprnt(x2, conjunction = NA)`
c. `r vecprnt(x3, conjunction = NA)`
d. `r vecprnt(x4, conjunction = NA)`

Match each set of observations to the corresponding histogram below.

```{r, fig.height = 2.5, warning = FALSE}
p <- ggplot(data.frame(x = x1), aes(x = x, y = 2*..density..))
p <- p + geom_histogram(breaks = seq(0, 10, by = 2), fill = "white", color = "black") 
p <- p + theme_classic() + labs(y = "Relative Frequency")
p <- p + scale_x_continuous(breaks = seq(0, 10, by = 2))

p1 <- p

p <- ggplot(data.frame(x = x2), aes(x = x, y = 2*..density..))
p <- p + geom_histogram(breaks = seq(0, 10, by = 2), fill = "white", color = "black") 
p <- p + theme_classic() + labs(y = "Relative Frequency")
p <- p + scale_x_continuous(breaks = seq(0, 10, by = 2)) + ylim(0,0.4)
p2 <- p

p <- ggplot(data.frame(x = x3), aes(x = x, y = 2*..density..))
p <- p + geom_histogram(breaks = seq(0, 10, by = 2), fill = "white", color = "black") 
p <- p + theme_classic() + labs(y = "Relative Frequency")
p <- p + scale_x_continuous(breaks = seq(0, 10, by = 2)) + ylim(0,0.4)
p3 <- p

p <- ggplot(data.frame(x = x4), aes(x = x, y = 2*..density..))
p <- p + geom_histogram(breaks = seq(0, 10, by = 2), fill = "white", color = "black") 
p <- p + theme_classic() + labs(y = "Relative Frequency")
p <- p + scale_x_continuous(breaks = seq(0, 10, by = 2)) + ylim(0,0.4)
p4 <- p

cowplot::plot_grid(p4, p3, p2, p1, nrow = 1, align = "h")
```

## Means, Variances, and Standard Deviations

1.$\!$ The three dot plots below each show the distribution of several observations of a quantitative variable $x$. Note that the values of the variable are 1, 2, 3, 4, or 5.
```{r, dotplots-a, fig.height = 1.6}
d1 <- data.frame(x = c(1,3,3,3,5))
d2 <- data.frame(x = c(1,2,3,4,5))
d3 <- data.frame(x = c(1,1,3,5,5))

p1 <- ggplot(d1, aes(x = x)) + geom_dotplot(binwidth = 0.5, stackratio = 1.1) + scale_x_continuous(breaks = 1:5)
p1 <- p1 + theme_classic() + noyaxis + ggtitle("A") + theme(axis.text = element_text(color = "black"))

p2 <- ggplot(d2, aes(x = x)) + geom_dotplot(binwidth = 0.5, stackratio = 1.1) + scale_x_continuous(breaks = 1:5)
p2 <- p2 + theme_classic() + noyaxis + ggtitle("B") + theme(axis.text = element_text(color = "black"))

p3 <- ggplot(d3, aes(x = x)) + geom_dotplot(binwidth = 0.5, stackratio = 1.1) + scale_x_continuous(breaks = 1:5)
p3 <- p3 + theme_classic() + noyaxis + ggtitle("C") + theme(axis.text = element_text(color = "black"))

cowplot::plot_grid(p1, p2, p3, nrow = 1)
```
Confirm that all three distributions have a mean of `r mean(d1$x)`. Also confirm that the variances of distributions *A*, *B*, and *C* are `r var(d1$x)`, `r var(d2$x)`, and `r var(d3$x)`, respectively, and that the standard deviations of distributions *A*, *B*, and *C* are (approximately) `r round(sd(d1$x),1)`, `r round(sd(d2$x),1)`, and `r round(sd(d3$x),1)`, respectively.

2.$\!$ The three dot plots below each show the distribution of several observations of a quantitative variable $x$. Note that the values of the variable are 1, 2, or 3. 
```{r, dotplots-b, fig.height = 1.6}
d1 <- data.frame(x = c(1,1,1,2,2,3))
d2 <- data.frame(x = c(1,1,2,2,3,3))
d3 <- data.frame(x = c(1,2,2,3,3,3))

p1 <- ggplot(d1, aes(x = x)) + geom_dotplot(binwidth = 0.25, stackratio = 1.1) + scale_x_continuous(breaks = 1:3)
p1 <- p1 + theme_classic() + noyaxis + ggtitle("A") + theme(axis.text = element_text(color = "black"))

p2 <- ggplot(d2, aes(x = x)) + geom_dotplot(binwidth = 0.25, stackratio = 1.1) + scale_x_continuous(breaks = 1:3)
p2 <- p2 + theme_classic() + noyaxis + ggtitle("B") + theme(axis.text = element_text(color = "black"))

p3 <- ggplot(d3, aes(x = x)) + geom_dotplot(binwidth = 0.25, stackratio = 1.1) + scale_x_continuous(breaks = 1:3)
p3 <- p3 + theme_classic() + noyaxis + ggtitle("C") + theme(axis.text = element_text(color = "black"))

cowplot::plot_grid(p1, p2, p3, nrow = 1)
```
Confirm that the means of distributions *A*, *B*, and *C* are (approximately) `r round(mean(d1$x),1)`, `r round(mean(d2$x),1)`, and `r round(mean(d3$x),1)`, respectively. Also confirm that distributions *A* and *C* both have standard deviations of approximately `r round(sd(d1$x),1)`, while distribution *B* has a slightly larger standard deviation of approximately `r round(sd(d2$x),1)`. 

3.$\!$  Create a sample of $n$ = 5 observations of a quantitative variable $x$, where each observation has a value of 1, 2, 3, 4, or 5, such that the sample has a mean of $\bar{x}$ = 2 and a variance of zero. Create another sample where the mean is also $\bar{x}$ = 2 but the variance is greater than zero. (Hint: For both problems it might be helpful to consider that if you made a dot plot it would need to have a center of mass at the mean. You might find it useful to help visualize the solution.)

4.$\!$ Consider the following distribution.
```{r}
set.seed(102)
y <- rpois(10, 1)
d <- data.frame(y = y) %>% group_by(y) %>% summarize(freq = n()) %>% 
  mutate(relfreq = freq/sum(freq), cumrelfreq = cumsum(relfreq)) %>%
  select(y, relfreq)
names(d) <- c("$x$","Relative Frequency")
ktbl(d) %>% column_spec(1:2, width = "2cm")
```
Confirm that the mean is $\bar{x}$ = `r mean(y)`.

5.$\!$  A sample includes several observations of a quantitative variable $x$. In this sample 10% of the observations have a value of $x$ = 1, 30% of the observations have a value of $x = 2$, and 60% observations have a value of $x$ = 3. Verify that the mean for this sample is $\bar{x}$ = `r crossprod(1:3, c(0.1, 0.3, 0.6))`. (Hint: Note that the percentages of 10%, 30%, and 60% correspond to relative frequencies of 0.1, 0.3, and 0.6, respectively.) 

6.$\!$  A sample includes $n$ = 100 observations of a quantitative variable $x$. Of these observations, $x$ = 1 for 60 observations, and $x$ = 2 for 40 observations. Verify that the mean of $x$ is $\bar{x}$ = `r crossprod(c(1,2), c(0.6,0.4))`.

\pagebreak

## Solutions

The solutions for the tabular representation of distributions and histogram problems are given below.

## Tabular Representations of Distributions

1.$\!$ The distribution is given in the following table.
```{r}
set.seed(101)
y <- rpois(10, 5)
d <- data.frame(y = y) %>% group_by(y) %>% summarize(freq = n()) %>% 
  mutate(relfreq = freq/sum(freq), cumrelfreq = cumsum(relfreq))
names(d) <- c("$x$","Frequency","Relative Frequency","Cumulative Relative Frequency")
ktbl(d) %>% column_spec(1:4, width = "2cm")
```

```{r}
set.seed(103)
y <- rpois(10, 5)
```

2.$\!$ The original observations (sorted in increasing order) are `r paste(sort(y), collapse= ", ")`.

## Histograms

1.$\!$ The histograms are shown below. 
```{r, fig.height = 4, warning = FALSE}
p <- ggplot(Sleuth3::case0101, aes(x = Score, y = ..density.. * 5))
p <- p + geom_histogram(breaks = seq(0, 30, by = 5), fill = "white", color = "black")
p <- p + labs(x = "Score", y = "Relative Frequency") + facet_wrap(~ Treatment)
p <- p + theme_minimal() + scale_x_continuous(breaks = seq(0, 30, by = 5))
plot(p)
```


2. From left to right the samples used to create the histograms are $d$, $c$, $b$, and $a$.
