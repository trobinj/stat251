---
output:
  html_document: 
    theme: readable
  pdf_document: default
---

```{r, echo = FALSE, message = FALSE}
library(lubridate)
date <- "01-18-2023"
weekday <- wday(mdy(date), label = TRUE, abbr = FALSE)
month <- month(mdy(date), label = TRUE)
day <- day(mdy(date))
```

---
title: `r paste(weekday, ", ", month, " ", day, sep = "")`
output:
  html_document: 
    theme: readable
  pdf_document: default
header-includes:
  - \usepackage{float}
  - \usepackage{booktabs}
  - \usepackage{array}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, out.width = "100%", fig.align = "center", cache = FALSE, dev = ifelse(knitr::is_html_output(), "png", "pdf"))
```

```{r packages}
library(tidyverse)
suppressWarnings(library(kableExtra))
```

```{r utilities}
source("../../utilities.R")
```

`r ifelse(knitr::is_html_output(), paste("You can also download a [PDF](lecture-", date, ".pdf) copy of this lecture.", sep = ""), "")`


## Summary Measures of a Distribution --- Continued

A couple of properties of a distribution that we often want to measure are *location* and *variability*.

### Measures of Variability

The **variance** for a sample of observations can be written as
$$
  s^2 = \frac{(x_1 - \bar{x})^2 + (x_2 - \bar{x})^2 + \cdots + (x_n - \bar{x})^2}{n-1} = 
  \frac{\sum_{i=1}^n (x_i - \bar{x})^2}{n-1}.
$$
**Example**: Consider the following sample of observations: 1, 1, 7. The mean is $\bar{x}$ = 3 and the variance is
$$
  s^2 = \frac{(1 - 3)^2 + (1 - 3)^2 + (7 - 3)^2}{3-1} = 12.
$$
A related measure is the **standard deviation** which is the square root of the variance, so it can be written as
$$
  s = \sqrt{\frac{(x_1 - \bar{x})^2 + (x_2 - \bar{x})^2 + \cdots + (x_n - \bar{x})^2}{n-1}} = 
  \sqrt{\frac{\sum_{i=1}^n (x_i - \bar{x})^2}{n-1}}.
$$
Note that the symbol for the variance is $s^2$ because the variance equals the square of the standard deviation ($s$). 

Another measure is the **range** which is simply defined as the difference between the largest and smallest values,
$$
  \text{range} = \max(x_1,x_2,\dots,x_n) - \min(x_1,x_2,\dots,x_n),
$$
and the **interquartile range** which we will discuss later. 

\pagebreak

## Cumulative Distributions

The **cumulative distribution** shows the relationship between the value of the variable and *cumulative relative frequency*.  

**Example**: The following is a hypothetical set of observations of examination scores.
```{r}
set.seed(123)
x <- rbinom(10, 10, 0.75)
d <- data.frame(x = x) %>% group_by(x) %>% summarize(freq = n()) %>% 
  mutate(relfreq = freq/sum(freq), cumrelfreq = cumsum(relfreq))
```
<center>

`r paste(sort(x), collapse = ", ")`

</center>

```{r}
d %>% rename("$x$" = x, "Frequency" = freq, "Relative Frequency" = relfreq, "Cumulative Relative Frequency" = cumrelfreq) %>% ktbl() %>% column_spec(1:4, width = "2cm")
```
We can graph the cumulative distribution using a *step function*.
```{r, fig.height = 3}
p <- ggplot(data.frame(x = x), aes(x = x)) + theme_minimal()
p <- p + stat_ecdf(geom = "step", pad = TRUE, alpha = 0.5)
p <- p + stat_ecdf(geom = "point", pad = FALSE)
p <- p + scale_y_continuous(breaks = seq(0, 1, by = 0.1), minor_breaks = NULL)
p <- p + labs(y = "Cumulative Relative Frequency")
plot(p)
```

\pagebreak

**Example**: Consider the cumulative distribution of the sample of observations of eruption duration of [Old Faithful](https://en.wikipedia.org/wiki/Old_Faithful).
```{r}
d <- faithful %>% select(eruptions) %>% mutate(eruptions = round(eruptions,1)) %>% group_by(eruptions) %>% summarize(freq = n()) %>% mutate(relfreq = freq/sum(freq)) %>% mutate(cumrelfreq = cumsum(relfreq)) %>% mutate(relfreq = round(relfreq,3), cumrelfreq = round(cumrelfreq,3))
names(d) <- c("Time","Frequency","Relative Frequency","Cumulative Relative Frequency")
ktbl(headtail(as.data.frame(d),5)) %>% column_spec(1:4, width = "2cm")
```
Note: The relative and cumulative relative frequencies above have been rounded.
```{r, fig.height = 4}
p <- ggplot(faithful, aes(x = round(eruptions,1))) + theme_minimal()
p <- p + stat_ecdf(geom = "step", pad = TRUE, alpha = 0.5)
p <- p + stat_ecdf(geom = "point", pad = FALSE, size = 0.75)
p <- p + scale_y_continuous(breaks = seq(0, 1, by = 0.1))
p <- p + labs(y = "Cumulative Relative Frequency", x = "Duration (min)")
plot(p)
```

### Finding Percentiles Using a Cumulative Distribution

The $P$th **percentile** is the value of the variable such that $P\%$ of the observations are *less than that value*.  

**Finding Percentiles**: Finding percentiles from a set of observations is surprisingly complex! Consider the following distribution.
```{r}
set.seed(123)
x <- rbinom(10, 10, 0.75)
d <- data.frame(x = x) %>% group_by(x) %>% summarize(freq = n()) %>% 
  mutate(relfreq = freq/sum(freq), cumrelfreq = cumsum(relfreq))
d %>% rename("$x$" = x, "Frequency" = freq, "Relative Frequency" = relfreq, "Cumulative Relative Frequency" = cumrelfreq) %>% ktbl() %>% column_spec(1:4, width = "2cm")
```
Here are a couple of examples.

1. What is the 60th percentile? *Several* values of $x$ would qualify! Any $x$ such that 7 $<$ x $\le$ 8 has 60% of the observations that are less than it.

2. What is the 70th percentile? *No* values of $x$ would qualify! The percent of observations less than 8 is 60%, and the percent of observations for any $x$ > 8 is 90% or more. 

One solution is to use the *midpoint in the first case*, and *the smallest value of $x$ that has more than $P$\% of observations less than it* in the second case. This is easier to explain/do using a graph of the cumulative distribution. 

**Finding Percentiles Using the Cumulative Distribution**: To find the approximate percentile using a *graph* of the cumulative relative distribution, find the value where the step function crosses the cumulative relative frequency of $P$/100. If more than one value crosses value, use the midpoint (i.e., average of the two values). 
\pagebreak

```{r}
probs <- c(0.25, 0.4, 0.5, 0.6, 0.7)
```

**Example**: We can confirm that the `r vecprnt(paste(probs*100, "th", sep = ""))` percentiles for the distribution show below are `r vecprnt(quantile(x, probs = probs, type = 2))`, respectively.

```{r, fig.height = 8}
p <- ggplot(data.frame(x = x), aes(x = x)) + theme_minimal()
p <- p + geom_hline(yintercept = probs, linetype = 2)
p <- p + stat_ecdf(geom = "step", pad = TRUE, alpha = 0.5)
p <- p + stat_ecdf(geom = "point", pad = FALSE)
p <- p + scale_y_continuous(breaks = seq(0, 1, by = 0.1))
p <- p + scale_x_continuous(breaks = seq(4, 10, by = 1))
p <- p + labs(y = "Cumulative Relative Frequency")
plot(p)
```

\pagebreak

**Example**: We can use the following plot to approximate the 25th, 50th, and 75th percentiles "by eye" (the actual percentiles are `r vecprnt(quantile(round(faithful$eruptions,1), probs = c(0.25, 0.5, 0.75), type = 2))`).
```{r, fig.height = 8}
p <- ggplot(faithful, aes(x = round(eruptions,1))) + theme_minimal()
#p <- p + geom_hline(yintercept = c(0.25, 0.5, 0.75), linetype = 2)
p <- p + stat_ecdf(geom = "step", pad = TRUE, alpha = 0.5)
p <- p + stat_ecdf(geom = "point", pad = FALSE, size = 0.75)
p <- p + scale_y_continuous(breaks = seq(0, 1, by = 0.1))
p <- p + scale_x_continuous(breaks = seq(1, 6, by = 0.2))
p <- p + labs(y = "Cumulative Relative Frequency", x = "Duration (min)")
plot(p)
```

\pagebreak

## Box Plots 

A **box plot** is a graphical representation of a distribution of a quantitative variable that uses what is called a **five-number summary**:

1. minimum
2. first quartile ($Q_1$) --- i.e., 25th percentile
3. second quartile ($Q_2)$ --- i.e., 50th percentile and median
4. third quartile ($Q_3$) --- i.e., 75th percentile
5. maximum

Comment: Because there is more than one way to approximate a percentile and thus a quartile, there is more than one way to draw a boxplot. For consistency we will use the approximation given earlier for finding percentiles.

**Example**: Box plot based on an earlier example. 

```{r, fig.height = 4}
p <- ggplot(data.frame(x = x), aes(x = x)) + theme_minimal()
p <- p + geom_hline(aes(yintercept = 0.25), linetype = 2)
p <- p + geom_hline(aes(yintercept = 0.50), linetype = 2)
p <- p + geom_hline(aes(yintercept = 0.75), linetype = 2)
p <- p + stat_ecdf(geom = "step", pad = TRUE, alpha = 0.5)
p <- p + stat_ecdf(geom = "point", pad = FALSE)
p <- p + scale_y_continuous(breaks = seq(0, 1, by = 0.1))
p <- p + scale_x_continuous(breaks = seq(4, 10, by = 1))
p <- p + labs(y = "Cumulative Relative Frequency")
pcdf <- p

myfive <- function(x) {
  r <- quantile(x, probs = c(0, 0.25, 0.5, 0.75, 1), type = 2)
  names(r) <- c("ymin", "lower", "middle", "upper", "ymax")
  return(r)
}

p <- ggplot(data.frame(x = x), aes(x = 1, y = x)) + theme_classic()
p <- p + scale_y_continuous(breaks = seq(4, 10, by = 1))
p <- p + stat_summary(fun.data = myfive, geom = "boxplot", fatten = 1) + coord_flip()
pbox <- p + noyaxis

cowplot::plot_grid(pcdf, pbox, nrow = 2, align = "v", rel_heights = c(2,1))
```
Note that the five number summary is `r vecprnt(quantile(x, probs = c(0, 0.25, 0.5, 0.75, 1), type = 2))`.

\pagebreak

**Example**: Box plot of the Old Faithful data.
```{r, fig.height = 8}
p <- ggplot(faithful, aes(x = round(eruptions,1))) + theme_minimal()
p <- p + stat_ecdf(geom = "step", pad = TRUE, alpha = 0.5)
p <- p + stat_ecdf(geom = "point", pad = FALSE, size = 0.75)
p <- p + scale_y_continuous(breaks = seq(0, 1, by = 0.1))
p <- p + scale_x_continuous(breaks = seq(1, 6, by = 0.2))
p <- p + labs(y = "Cumulative Relative Frequency", x = "Duration (min)")
pcdf <- p

p <- ggplot(faithful, aes(x = 1, y = round(eruptions,1))) + theme_classic()
p <- p + scale_y_continuous(breaks = seq(1, 6, by = 0.2))
p <- p + stat_summary(fun.data = myfive, geom = "boxplot", fatten = 1) + coord_flip()
pbox <- p + noyaxis + labs(y = "Duration (min)")

cowplot::plot_grid(pcdf, pbox, nrow = 2, align = "v", rel_heights = c(3,1))
```
Note that the five number summary is `r vecprnt(quantile(round(faithful$eruptions,1), probs = c(0, 0.25, 0.5, 0.75, 1), type = 2))`.

A box plot visually depicts three summary measures: the **median** (i.e., $Q_2$), **range** (i.e., maximum $-$ minimum), and **interquartile range** (i.e., $Q_3-Q_1$).

\pagebreak

**Example**: Cumulative distributions and box plots of the data from the study on creativity and motivation.
```{r, fig.height = 8}
p <- ggplot(Sleuth3::case0101, aes(x = Score, color = Treatment)) + theme_classic()
p <- p + labs(y = "Cumulative Relative Frequency", color = "Motivation")
p <- p + theme(panel.grid.major = element_line(colour = "black", linetype = 3, linewidth = 0.1))
p <- p + stat_ecdf(geom = "step", pad = TRUE) 
p <- p + stat_ecdf(geom = "point", pad = FALSE, size = 0.75)
p <- p + scale_x_continuous(breaks = seq(0, 30, by = 1))
p <- p + scale_y_continuous(breaks = seq(0, 1, by = 0.1), limits = c(0,1))
p <- p + theme(legend.position = c(0.9, 0.3))
p1 <- p

p <- ggplot(Sleuth3::case0101, aes(x = Treatment, y = Score, color = Treatment)) + theme_classic()
p <- p + scale_y_continuous(breaks = seq(0, 30, by = 1)) + theme(legend.position = "none") + labs(x = "Motivation")
p <- p + stat_summary(fun.data = myfive, geom = "boxplot", fatten = 1) + coord_flip() + labs(y = "Score")
p2 <- p

cowplot::plot_grid(p1, p2, nrow = 2, align = "vh", axis = "vh", rel_heights = c(3,1))
```

\pagebreak

**Example**: Distribution of examination scores from Stat 251, Fall 2016.
```{r, fig.height = 3, warning = FALSE}
d <- read.table(header = TRUE, sep = ",", text = "
Q1,Q2,Q3,Q4,Q5,Q6,Final
                  10,8,9,9,9.5,8.5,16.5
                  2.5,7,,,,,6.5
                  3.5,5,6,6.5,5.5,5.5,6.5
                  9,5,4,7,8,6.5,8.75
                  6.5,7,7,6.5,6.5,8.5,13.5
                  7,7.5,3,5.5,5,6,13.5
                  7.5,9,7.5,8.5,8.5,7,18
                  7.5,7,10,10,9.5,9,16.75
                  10,7.5,8.5,8,9,7.5,15.75
                  5,8,8,5.5,5.5,6,12.75
                  8.5,6.5,8,7.5,6.5,4.5,13.25
                  7,4.5,7.5,6,5,7,11
                  7,6,8,8,8.5,9,19.75
                  9,7.5,4.5,6,,,
                  7,8.5,8.5,8,5.5,6,17.75
                  10,8,10,8,9.5,9.5,17.75
                  6.5,5,6.5,4,6.5,3.5,8.5
                  8,7,7,9,6.5,,
                  10,10,7,7.5,8.5,7.5,16.75
                  7,4.5,5,7,7,6.5,4
                  9,5.5,8.5,8.5,9,9,18.5
                  9,5.5,7,8,9.5,5.5,18.75
                  8.5,4,4.5,8,7.5,7.5,14.75
                  7,6.5,4,4,7.5,3.5,11.25
                  5,,,4.5,3,,11.25
                  7.5,8.5,3,8,9,,15.75
                  7.5,5.5,8,5,5,6.5,12.5
                  9,6,6.5,7.5,8,8,14.5
                  9.5,5.5,8,7.5,6.5,7.5,14.75
                  10,9.5,10,9,8,10,20
                  7.5,5.5,8,7.5,7.5,5,12.75
                  4.5,6.5,4.5,6,8,7.5,5
                  7,10,,6,9.5,4,16.75
                  7,5.5,7,6,9,7,12.75
                  8.5,6,4.5,7,7,6,9.75
                  4,4.5,3,6.5,6.5,6.5,12.5
                  10,10,10,9,9,,20
                  10,9,7.5,4.5,8,7.5,15.25
                  6.5,7,9,8.5,8,3.5,11.25
                  4.5,3,,,,,
                  10,6.5,,8,9,9,19
                  10,7,7,9,9.5,7.5,17
                  8,7,6,7,8.5,4.5,11
                  9.5,9,6.5,6,7.5,4.5,16.25
                  10,5.5,7,8.5,7,8,16.25
                  5,4,5,3.5,6,7.5,8.75
                  5,4,4,1,2.5,3.5,5.25
                  8.5,5,9,4.5,7,10,18.75
                  9.5,6,,5.5,4,7,14.75
                  3.5,6.5,6.5,8,9,8.5,16.5
                  9.5,8.5,10,7,9,9,18.5
                  10,10,8.5,9,9,8.5,16.5
                  8.5,7.5,7,7,9,9,17.25
                  9,6,4.5,7,8,8.5,16.75
                  8.5,8.5,5.5,6,7,7,13.25
                  9,7.5,9.5,8,8.5,8,18
                  10,10,9,10,10,10,20
                  9,8,5.5,9,7.5,9.5,15.75
                  10,6,7.5,9,8,8,17.75
                  ,,,,,,
                  8,6,8.5,8,9,8,17.5
                  2,6,3,4,,,
                  8,5.5,,8.5,4.5,7.5,13.5
                  5,2.5,6,6.5,5.5,2,7.25
                  10,6,7.5,8,9,9,13.75
                  7,,5.5,7.5,6.5,6.5,11
                  7.5,,6.5,5.5,6,7.5,15.25
                  8,6,4,4.5,7.5,8.5,13
                  7.5,7.5,7,,7.5,8,15.5
                  10,7.5,7.5,8,7,5.5,10.75
                  8.5,10,9,9,9.5,7,16.5
                  8,8.5,7.5,9,9.5,9,18.5
                  9,7.5,9,8,7,8,15.25
                  7,4.5,6.5,6,4.5,7,14.75
                  4.5,8,3.5,7,7.5,6.5,16.5
                  7.5,7,6,8.5,9.5,7.5,13.5
                  10,7.5,10,6.5,9,7,10.75
                  4.5,7.5,3.5,5,3,6,11
                  5,5,7.5,6.5,9,7.5,13.75
                  8,6.5,4.5,9,9,6.5,15.25
                  9.5,9.5,8,8,10,6.5,18
                  10,4,6,6,6.5,4.5,13.5
                  6,7.5,7,6,7,3.5,10.25
                  10,5.5,9,8,7,7.5,19
                  6.5,6,9.5,9,9,10,15.5
                  7.5,6,9.5,8.5,5,7,10.75
                  10,8,8,10,9.5,9.5,18.75
                  9.5,5,7.5,8,8.5,9,20
                  7,5.5,,5,,,
                  7.5,9,7,7.5,8,7.5,14.5
                  10,9.5,10,10,9,10,19.75
                  6.5,6.5,7,8,5.5,4.5,12.5
                  9,6,3,,4,4,11
                  5.5,5.5,6.5,7.5,,,10.5
                  9,5,8,7,7.5,8,18.5
                  6.5,5,,,,,
                  5,4.5,,8,7.5,6.5,16.5
                  10,8,7,,2.5,5,11.5
                  7.5,7,5,9,6.5,5.5,14.75
                  10,6.5,9,10,,8,
                  5.5,8,8.5,8.5,9,7,15.5
                  6,5.5,5,,,,
                  2.5,4.5,,3.5,2.5,4,8.25
                  8.5,9,7,8,9.5,6,15.75
                  8.5,6.5,9,7,6.5,6.5,17.75
                  8.5,7,7,6.5,8.5,5,12.5
                  9,9,9.5,7,6.5,7.5,12
                  4,7.5,8,8.5,7,4.5,10.25
                  7.5,8,1,2,7,5,10.5
                  9,10,9,7.5,9,10,19.5
                  10,7.5,6.5,8,9,9,17.75
                  7.5,8.5,8,9,9.5,9.5,20
                  8,7.5,9,8.5,7.5,10,18.25
                  8.5,8.5,7.5,8,6.5,6.5,15
                  10,10,10,10,10,10,20")

names(d)[1:6] <- paste("E", 1:6, sep = "")
d <- d %>% pivot_longer(cols = E1:Final, names_to = "Examination", values_to = "Score") %>% mutate(Score = ifelse(Examination == "Final", Score/20, Score/10)*100)

p <- ggplot(d, aes(x = Examination, y = Score)) + theme_minimal()
p <- p + stat_summary(fun.data = myfive, geom = "boxplot", fatten = 1) + coord_flip()
p <- p + scale_y_continuous(breaks = seq(0, 100, by = 10), limits = c(0,100))
p <- p + labs(x = "Score (Percent)")
plot(p)
```

**Example**: Distribution of response times for 11 non-schizophrenic individuals and six schizophrenic individuals.
```{r, fig.height = 4}
data(schiz, package = "BayesDA")
d <- as.data.frame(t(schiz))
d$schizophrenic <- factor(rep(c("no","yes"), c(11,6)))
rownames(d) <- NULL
names(d)[1:30] <- paste("rt", 1:30, sep = "")
d$subject <- 1:nrow(d)
d$subject <- factor(d$subject)
d <- reshape2::melt(d, measure.var = 1:30, variable.name = "trial", value.name = "time")
levels(d$schizophrenic) <- c("Not Schizophrenic", "Schizophrenic")
d$schizophrenic <- factor(d$schizophrenic, levels = rev(levels(d$schizophrenic)))

p <- ggplot(d, aes(x = subject, y = time)) + theme_minimal()
p <- p + stat_summary(fun.data = myfive, geom = "boxplot", fatten = 1, width = 0.6) + coord_flip()
p <- p + facet_grid(schizophrenic ~ ., scales = "free_y", space = "free_y")
p <- p + labs(x = "Subject", y = "Response Time (msec)")
plot(p)
```

**Example**: Distributions of samples of observations of the weights of gold sovereigns collected from circulation in Manchester, England. 
```{r, fig.height = 4}
set.seed(123)

coins <- alr4::jevons %>% uncount(n) %>% 
  group_by(Age) %>% mutate(y = rnorm(n(), Weight, SD)) %>%
  mutate(y = SD * (y - mean(y))/sd(y) + Weight) %>%
  select(Age, y) 

coins_quantiles <- coins %>% group_by(Age) %>% 
  summarize(min = min(y), 
            Q1 = quantile(y, 0.25, type = 2),
            Q2 = quantile(y, 0.5, type = 2), 
            Q3 = quantile(y, 0.75, type = 2),
            max = max(y), mean = mean(y), sd = sd(y), n = n(), IQR = Q3-Q1) %>%
  select(c(Age, n, mean, sd, min, Q1, Q2, Q3, max, IQR))

p <- ggplot(coins, aes(x = factor(Age), y = y)) + theme_minimal() + 
  geom_dotplot(binaxis = "y", binwidth = 0.001, method = "histodot") +
  coord_flip() + labs(x = "Age (decades)", y = "Weight (g)") + 
  geom_boxplot(aes(y = NULL, ymin = min, lower = Q1, middle = Q2, upper = Q3, ymax = max),
    stat = "identity", fill = NA, fatten = 1, data = coins_quantiles)
plot(p)

options(digits = 4)
coins_quantiles %>% arrange(desc(Age)) %>% ktbl()
```

\pagebreak

## Distribution Shapes

Some terms we use to describe the *shape* of the distribution of a quantitative variable: *symmetric*, *uniform*, *left-skewed*, *right-skewed*, *uni-modal*, *bi-modal*.

**Example**: Uniform and symmetric.
```{r, fig.height = 3.5, warning = FALSE}
set.seed(123)
d <- data.frame(x = round(rbeta(1000, 1, 1)*100))

p <- ggplot(d, aes(x = x, y = ..density.. * 10))
p <- p + geom_histogram(breaks = seq(0, 100, by = 10), color = "black", fill = "white")
p <- p + scale_x_continuous(breaks = seq(0, 100, by = 10))
p <- p + theme_minimal() + noyaxis
phst <- p

p <- ggplot(d, aes(x = 1, y = x)) + theme_classic()
p <- p + scale_y_continuous(breaks = seq(0, 100, by = 10)) + noyaxis
p <- p + stat_summary(fun.data = myfive, geom = "boxplot", fatten = 1) + coord_flip()
pbox <- p

cowplot::plot_grid(phst, pbox, nrow = 2, align = "vh", axis = "vh", rel_heights = c(2,1))
```

**Example**: Uni-modal and symmetric.
```{r, fig.height = 3.5, warning = FALSE}
set.seed(123)
d <- data.frame(x = round(rbeta(10000, 3, 3)*100))

p <- ggplot(d, aes(x = x, y = ..density.. * 10))
p <- p + geom_histogram(breaks = seq(0, 100, by = 10), color = "black", fill = "white")
p <- p + scale_x_continuous(breaks = seq(0, 100, by = 10))
p <- p + theme_minimal() + noyaxis
phst <- p

p <- ggplot(d, aes(x = 1, y = x)) + theme_classic()
p <- p + scale_y_continuous(breaks = seq(0, 100, by = 10)) + noyaxis
p <- p + stat_summary(fun.data = myfive, geom = "boxplot", fatten = 1) + coord_flip()
pbox <- p

cowplot::plot_grid(phst, pbox, nrow = 2, align = "vh", axis = "vh", rel_heights = c(2,1))
```

\pagebreak

**Example**: Bi-modal and symmetric.
```{r, fig.height = 3.5, warning = FALSE}
set.seed(123)
d <- data.frame(x = round(c(rbeta(5000, 10, 2), rbeta(5000, 2, 10))*100,1))

p <- ggplot(d, aes(x = x, y = ..density.. * 10))
p <- p + geom_histogram(breaks = seq(0, 100, by = 10), color = "black", fill = "white")
p <- p + scale_x_continuous(breaks = seq(0, 100, by = 10))
p <- p + theme_minimal() + noyaxis
phst <- p

p <- ggplot(d, aes(x = 1, y = x)) + theme_classic()
p <- p + scale_y_continuous(breaks = seq(0, 100, by = 10)) + noyaxis
p <- p + stat_summary(fun.data = myfive, geom = "boxplot", fatten = 1) + coord_flip()
pbox <- p

cowplot::plot_grid(phst, pbox, nrow = 2, align = "vh", axis = "vh", rel_heights = c(2,1))
```

**Example**: Left-skewed and uni-modal.
```{r, fig.height = 3.5, warning = FALSE}
set.seed(123)
d <- data.frame(x = round(rbeta(10000, 7, 2)*100,1))

p <- ggplot(d, aes(x = x, y = ..density.. * 10))
p <- p + geom_histogram(breaks = seq(0, 100, by = 10), color = "black", fill = "white")
p <- p + scale_x_continuous(breaks = seq(0, 100, by = 10))
p <- p + theme_minimal() + noyaxis
phst <- p

p <- ggplot(d, aes(x = 1, y = x)) + theme_classic()
p <- p + scale_y_continuous(breaks = seq(0, 100, by = 10)) + noyaxis
p <- p + stat_summary(fun.data = myfive, geom = "boxplot", fatten = 1) + coord_flip()
pbox <- p

cowplot::plot_grid(phst, pbox, nrow = 2, align = "vh", axis = "vh", rel_heights = c(2,1))
```

\pagebreak

**Example**: Right-skewed and uni-modal.
```{r, fig.height = 3.5, warning = FALSE}
set.seed(123)
d <- data.frame(x = round(rbeta(10000, 2, 7)*100,1))

p <- ggplot(d, aes(x = x, y = ..density.. * 10))
p <- p + geom_histogram(breaks = seq(0, 100, by = 10), color = "black", fill = "white")
p <- p + scale_x_continuous(breaks = seq(0, 100, by = 10))
p <- p + theme_minimal() + noyaxis
phst <- p

p <- ggplot(d, aes(x = 1, y = x)) + theme_classic()
p <- p + scale_y_continuous(breaks = seq(0, 100, by = 10)) + noyaxis
p <- p + stat_summary(fun.data = myfive, geom = "boxplot", fatten = 1) + coord_flip()
pbox <- p

cowplot::plot_grid(phst, pbox, nrow = 2, align = "vh", axis = "vh", rel_heights = c(2,1))
```
